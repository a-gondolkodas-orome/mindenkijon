<!DOCTYPE html>
<html lang="hu">
<head>
  <title>H-sz√©f</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --primary-color: #3498db;
      --primary-hover: #2980b9;
      --success-color: #2ecc71;
      --error-color: #e74c3c;
      --background-color: #ecf0f1;
      --text-color: #333;
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: var(--text-color);
      background-color: #f9f9f9;
      margin: 0;
      padding: 20px;
    }

    h1 {
      margin-bottom: 20px;
    }

    .game-container {
      position: relative;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      overflow: hidden;
    }

    canvas {
      border-radius: 8px;
      background-color: var(--background-color);
      display: block;
    }

    .control-button {
      position: absolute;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      user-select: none;
      transition: all 0.2s ease;
      font-size: 16px;
      font-weight: bold;
      border-radius: 50%;
      color: white;
      background-color: var(--primary-color);
      width: 24px;
      height: 24px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .control-button:hover {
      background-color: var(--primary-hover);
      transform: scale(1.1);
    }

    .control-button:active {
      transform: scale(0.95);
    }

    #resetButton {
      margin-top: 20px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background-color: var(--primary-color);
      color: white;
      border: none;
      cursor: pointer;
      font-size: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: all 0.2s ease;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    #resetButton:hover {
      background-color: var(--primary-hover);
      transform: scale(1.05);
    }

    #resetButton:active {
      transform: scale(0.95);
    }

    #congratsMessage {
      margin-top: 20px;
      font-weight: bold;
      color: var(--success-color);
      white-space: pre-line;
      text-align: center;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.5s ease-in-out;
    }

    @media (max-width: 600px) {
      .control-button {
        width: 20px;
        height: 20px;
        font-size: 14px;
      }
      
      #resetButton {
        width: 50px;
        height: 50px;
        font-size: 20px;
      }
    }
  </style>
</head>
<body>

<h1>H-sz√©f</h1>

<div class="game-container">
  <canvas id="gameCanvas"></canvas>
  <div id="controlButtons"></div>
</div>

<button id="resetButton" aria-label="√öjraind√≠t√°s">‚ü≥</button>

<div id="congratsMessage"></div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const GameState = {
      PLAYING: 'playing',
      SOLVED: 'solved'
    };

    class IncrementGame {
      constructor() {
        this.canvas = document.getElementById('gameCanvas');
        this.ctx = this.canvas.getContext('2d');
        this.controlButtonsDiv = document.getElementById('controlButtons');
        this.resetButton = document.getElementById('resetButton');
        this.congratsMessageDiv = document.getElementById('congratsMessage');
        
        this.numRows = 7;
        this.numCols = 5;
        this.cellSize = 0;
        this.state = GameState.PLAYING;
        
        this.table = Array(this.numRows).fill().map(() => Array(this.numCols).fill(0));
        
        this.targetTable = [
          [1, null, null, null, 11],
          [2, null, null, null, 12],
          [3, null, null, null, 13],
          [4,    8,    9,   10, 14],
          [5, null, null, null, 15],
          [6, null, null, null, 16],
          [7, null, null, null, 17]
        ];
        
        this.init();
      }
      
      init() {
        this.setupEventListeners();
        this.resizeCanvas();
        this.resetGame();
      }
      
      setupEventListeners() {
        this.resetButton.addEventListener('click', () => this.resetGame());
        window.addEventListener('resize', () => this.resizeCanvas());
      }
      
      resizeCanvas() {
        const minDimension = Math.min(window.innerWidth <= 600 ? 350 : 600, window.innerHeight);
        this.cellSize = Math.floor(minDimension / Math.max(this.numRows, this.numCols));
        
        this.canvas.width = this.numCols * this.cellSize;
        this.canvas.height = this.numRows * this.cellSize;
        
        this.drawTable();
        this.createControlButtons();
      }
      
      resetGame() {
        this.table = Array(this.numRows).fill().map(() => Array(this.numCols).fill(0));
        this.state = GameState.PLAYING;
        this.congratsMessageDiv.textContent = '';
        this.congratsMessageDiv.style.opacity = '0';
        this.drawTable();
        this.createControlButtons();
      }
      
      drawTable() {
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
        
        const normalFontSize = this.cellSize * 0.3;
        const smallFontSize = this.cellSize * 0.15;
        
        this.ctx.textAlign = 'center';
        this.ctx.textBaseline = 'middle';
        
        for (let i = 0; i < this.numRows; i++) {
          for (let j = 0; j < this.numCols; j++) {
            if (this.targetTable[i][j] !== null) {
              // Determine cell background color
              if (this.table[i][j] === this.targetTable[i][j]) {
                this.ctx.fillStyle = '#d5f5e3'; // Light green
              } else if (this.table[i][j] > this.targetTable[i][j]) {
                this.ctx.fillStyle = '#fadbd8'; // Light red
              } else {
                this.ctx.fillStyle = 'white';
              }
              
              // Draw cell
              this.ctx.fillRect(j * this.cellSize, i * this.cellSize, this.cellSize, this.cellSize);
              this.ctx.strokeStyle = '#bdc3c7';
              this.ctx.lineWidth = 1;
              this.ctx.strokeRect(j * this.cellSize, i * this.cellSize, this.cellSize, this.cellSize);
              
              // Draw current value
              this.ctx.fillStyle = '#2c3e50';
              this.ctx.font = `${normalFontSize}px 'Segoe UI', sans-serif`;
              this.ctx.fillText(
                this.table[i][j], 
                j * this.cellSize + this.cellSize / 2, 
                i * this.cellSize + this.cellSize / 2 - 10
              );
              
              // Draw target value
              this.ctx.font = `${smallFontSize}px 'Segoe UI', sans-serif`;
              this.ctx.fillStyle = '#7f8c8d';
              this.ctx.fillText(
                `(${this.targetTable[i][j]})`, 
                j * this.cellSize + this.cellSize / 2, 
                (i + 1) * this.cellSize - 20
              );
            }
          }
        }
        
        this.checkIfSolved();
      }
      
      createControlButtons() {
        this.controlButtonsDiv.innerHTML = '';
        const thirdPoint = this.cellSize / 3;
        
        // Create horizontal buttons
        this.createHorizontalButtons(thirdPoint);
        
        // Create vertical buttons
        this.createVerticalButtons(thirdPoint);
      }
      
      createHorizontalButtons(thirdPoint) {
        for (let i = 0; i < this.numRows; i++) {
          for (let j = 0; j < this.numCols - 1; j++) {
            if (this.targetTable[i][j] !== null && this.targetTable[i][j + 1] !== null) {
              // Plus button
              this.createButton(
                '+',
                (j + 1) * this.cellSize,
                i * this.cellSize + thirdPoint,
                () => this.incrementHorizontal(i, j)
              );
              
              // Minus button
              this.createButton(
                '-',
                (j + 1) * this.cellSize,
                i * this.cellSize + 2 * thirdPoint,
                () => this.decrementHorizontal(i, j)
              );
            }
          }
        }
      }
      
      createVerticalButtons(thirdPoint) {
        for (let i = 0; i < this.numRows - 1; i++) {
          for (let j = 0; j < this.numCols; j++) {
            if (this.targetTable[i][j] !== null && this.targetTable[i + 1][j] !== null) {
              // Plus button
              this.createButton(
                '+',
                j * this.cellSize + thirdPoint,
                (i + 1) * this.cellSize,
                () => this.incrementVertical(i, j)
              );
              
              // Minus button
              this.createButton(
                '-',
                j * this.cellSize + 2 * thirdPoint,
                (i + 1) * this.cellSize,
                () => this.decrementVertical(i, j)
              );
            }
          }
        }
      }
      
      createButton(text, left, top, clickHandler) {
        const button = document.createElement('div');
        button.classList.add('control-button');
        button.textContent = text;
        button.style.left = `${left}px`;
        button.style.top = `${top}px`;
        button.addEventListener('click', clickHandler);
        this.controlButtonsDiv.appendChild(button);
      }
      
      incrementHorizontal(y, x) {
        if (this.state === GameState.PLAYING) {
          this.table[y][x]++;
          this.table[y][x + 1]++;
          this.drawTable();
        }
      }
      
      decrementHorizontal(y, x) {
        if (this.state === GameState.PLAYING) {
          this.table[y][x]--;
          this.table[y][x + 1]--;
          this.drawTable();
        }
      }
      
      incrementVertical(y, x) {
        if (this.state === GameState.PLAYING) {
          this.table[y][x]++;
          this.table[y + 1][x]++;
          this.drawTable();
        }
      }
      
      decrementVertical(y, x) {
        if (this.state === GameState.PLAYING) {
          this.table[y][x]--;
          this.table[y + 1][x]--;
          this.drawTable();
        }
      }
      
      checkIfSolved() {
        for (let i = 0; i < this.numRows; i++) {
          for (let j = 0; j < this.numCols; j++) {
            if (this.targetTable[i][j] !== null && this.table[i][j] !== this.targetTable[i][j]) {
              return false;
            }
          }
        }
        
        if (this.state !== GameState.SOLVED) {
          this.state = GameState.SOLVED;
          this.congratsMessageDiv.textContent = "Megoldottad a feladatot, gratul√°lunk! üéâ";
          this.congratsMessageDiv.style.opacity = '1';
          
          // Animate the success message
          setTimeout(() => {
            this.congratsMessageDiv.style.opacity = '1';
          }, 100);
        }
        
        return true;
      }
    }
    
    // Initialize the game
    const game = new IncrementGame();
  });
</script>

</body>
</html>
